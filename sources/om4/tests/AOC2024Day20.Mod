MODULE AOC2024Day20;
  IMPORT CRC32, Texts, TE := TextsEx2, Oberon, System, U := AOCUtils, L := SystemLog;

  CONST MAZE_SIZE = 200;

  TYPE Int = LONGINT;
    ProcessProc = PROCEDURE (p, p2: U.Vector; sav: Int);

  VAR W: Texts.Writer;
    input: ARRAY MAZE_SIZE, MAZE_SIZE OF CHAR; d: ARRAY MAZE_SIZE, MAZE_SIZE OF Int;
    mazeXlen, mazeYlen: INTEGER; distComputed: BOOLEAN;
    ch100: INTEGER;

  PROCEDURE dist(p: U.Vector): Int;
    RETURN d[p.y, p.x]
  END dist;

  PROCEDURE computeCheats(cl: INTEGER; process: ProcessProc);
    VAR i, j, k ,l: INTEGER; dm,limK, limL, rcl: INTEGER;
      p0, p1: U.Vector;
  BEGIN
    FOR i := 0 TO mazeYlen - 1 DO LED(i); limK := U.min(i + cl, mazeYlen - 1);
      FOR j := 0 TO mazeXlen -1 DO p0.x := j; p0.y := i;
        IF dist(p0) < U.LONG_MAX THEN
          FOR k := U.max(0, i - cl) TO limK DO rcl := cl - ABS(k - i); limL := U.min(j + rcl, mazeXlen -1 );
            FOR l := U.max(0, j - rcl) TO limL DO p1.x := l; p1.y := k;
              dm := U.manhattan(p0, p1); ASSERT(dm <= cl);
              IF (dist(p1) < U.LONG_MAX) & (dm <= cl) & (dist(p1) > dist(p0) + dm) THEN
                (* la triche fonctionne *)
                process(p0, p1, dist(p1) - (dist(p0) + dm))
              END
            END
          END
        END
      END
    END
  END computeCheats;

  PROCEDURE printCheat(p1, p2: U.Vector; sav: Int);
  BEGIN U.printVector(W, p1); Texts.Write(W, "-");U.printVector(W, p2); TE.WriteLongInt(W, sav, 1); Texts.WriteLn(W);
    Texts.Append(Oberon.Log, W.buf)
  END printCheat;

  
  PROCEDURE storeCount(p, p2: U.Vector; sav: Int);
  BEGIN
    IF sav >= 100 THEN INC(ch100) END
  END storeCount;

  PROCEDURE parse*;
    VAR S!: TE.Scanner; ch: CHAR; x: INTEGER;
        BEGIN mazeXlen := 0; mazeYlen := 0; x := 0; Texts.OpenScanner(S, Oberon.Par.text, Oberon.Par.pos); Texts.Read(S, ch);
    WHILE ch = Texts.CR DO Texts.Read(S, ch) END;
    WHILE (ch = "#") OR (ch = ".") OR (ch = "S") OR (ch = "E") OR (ch = Texts.CR) DO
      IF ch = Texts.CR THEN
        IF mazeYlen = 0 THEN mazeXlen := x ELSE ASSERT (mazeXlen = x) END;
        INC(mazeYlen); x := 0
      ELSE input[mazeYlen, x] := ch; INC(x)
      END;
      Texts.Read(S, ch)
    END; distComputed := FALSE;
    L.DebugInt("mazeXlen", mazeXlen, 1); L.DebugInt("mazeXlen", mazeXlen, 1);
  END parse;

  PROCEDURE computeDistance*;
    VAR needMore: BOOLEAN; cs: Int;
      i, j, cd, k, l, nk, nl: INTEGER; p, pi: U.Vector;
      nbt: INTEGER;
  BEGIN p.x := -1; p.y := -1; i := 0;
    WHILE i < mazeYlen DO j := 0;
      WHILE j < mazeXlen DO
        IF input[i, j] = "E" THEN (* position de sortie *)
          p.x := j; p.y := i; i := mazeYlen; j := mazeXlen (*break*)
        END; INC(j)
      END; INC(i)
    END;
    ASSERT((p.x # -1) & (p.y # -1));

    pi.x := -1; pi.y := -1; i := 0;
    WHILE i < mazeYlen DO j := 0;
      WHILE j  < mazeXlen DO
        IF input[i, j] = "S" THEN (* position d'entr\E9e *)
          pi.x := j; pi.y := i; i := mazeYlen; j := mazeXlen (*break*)
        END; INC(j)
      END; INC(i)
    END;
    ASSERT((pi.x # -1) & (pi.y # -1));

    FOR i := 0 TO mazeYlen -1 DO FOR j := 0 TO mazeXlen - 1 DO d[i, j] := U.LONG_MAX END END;
    d[p.y, p.x] := 0; (* la case finale est \E0 une distance de 0 *)

    (* calcul de la distance minimale entre chaque case et la case finale *)
    REPEAT needMore := FALSE; nbt := 0;
      FOR i := 0 TO mazeYlen - 1 DO
        FOR j := 0 TO mazeXlen - 1 DO cs := d[i, j];
          IF cs < U.LONG_MAX THEN (* case visit\E9e *)
            (* propagation de la mise \E0 jour de la distance *)
            k := i; l := j; cd := 0;
            REPEAT nk := k + U.DIRECTION4[cd].y; nl := l + U.DIRECTION4[cd].x;
              IF (input[nk, nl] # "#") & (d[nk, nl]  > cs + 1) THEN needMore := TRUE; k := nk; l := nl; INC(cs); d[k,l] := cs; cd := 0; INC(nbt) END;
              INC(cd)
            UNTIL cd = LEN(U.DIRECTION4)
          END
        END
      END; LED(nbt)
    UNTIL ~needMore;
    L.DebugLongInt("Dist entr\E9e", dist(pi), 1); distComputed := TRUE
  END computeDistance;

  PROCEDURE count2*;
  BEGIN IF ~distComputed THEN parse; computeDistance END;
    ch100 := 0;
    computeCheats(2, storeCount);
    Texts.WriteString(W, "Partie 1: nb of cheats that saves >= 100ps = "); Texts.WriteInt(W, ch100, 1); Texts.WriteLn(W);
    Texts.Append(Oberon.Log, W.buf);
  END count2;

  PROCEDURE count20*;
  BEGIN IF ~distComputed THEN parse; computeDistance END;
    ch100 := 0;
    computeCheats(20, storeCount);
    Texts.WriteString(W, "Partie 2: nb of cheats that saves >= 100ps = "); Texts.WriteInt(W, ch100, 1); Texts.WriteLn(W);
    Texts.Append(Oberon.Log, W.buf);
  END count20;

  PROCEDURE list2*;
  BEGIN IF ~distComputed THEN parse; computeDistance END;
    computeCheats(2, printCheat);
  END list2;

BEGIN Texts.OpenWriter(W);
END AOC2024Day20.

OM4P2.Compile AOC2024Day20.Mod/s ~ System.Free AOC2024Day20 AOCUtils UTHash SystemLog ~

AOC2024Day20.computeDistance
AOC2024Day20.count20
AOC2024Day20.list2
AOC2024Day20.parse
###############
#...#...#.....#
#.#.#.#.#.###.#
#S#...#.#.#...#
#######.#.#.###
#######.#.#...#
#######.#.###.#
###..E#...#...#
###.#######.###
#...###...#...#
#.#####.#.###.#
#.#...#.#.#...#
#.#.#.#.#.#.###
#...#...#...###
###############
~

Partie 1: nb of cheats that saves >= 100ps = 1384
Partie 2: nb of cheats that saves >= 100ps = 1008542
AOC2024Day20.parse
#############################################################################################################################################
#...............#...#...#.......#...#.........###...#...#.....#...#...........#...###.....###.....#.....#...###.........#...#...#...###.....#
#.#############.#.#.#.#.#.#####.#.#.#.#######.###.#.#.#.#.###.#.#.#.#########.#.#.###.###.###.###.#.###.#.#.###.#######.#.#.#.#.#.#.###.###.#
#.....#.......#.#.#...#.#.....#...#.#...#.....#...#.#.#...#...#.#.#.......#...#.#...#...#.#...#...#.#...#.#.#...#.......#.#.#.#.#.#...#...#.#
#####.#.#####.#.#.#####.#####.#####.###.#.#####.###.#.#####.###.#.#######.#.###.###.###.#.#.###.###.#.###.#.#.###.#######.#.#.#.#.###.###.#.#
#...#...#.....#...#...#.#...#.....#...#.#.....#...#...#.....#...#...###...#...#...#...#.#.#...#...#.#.#...#.#...#.....###.#.#.#...#...#...#.#
#.#.#####.#########.#.#.#.#.#####.###.#.#####.###.#####.#####.#####.###.#####.###.###.#.#.###.###.#.#.#.###.###.#####.###.#.#.#####.###.###.#
#.#.#...#.....#...#.#.#...#.#...#.#...#.....#...#...#...#...#.....#...#.....#...#.#...#.#.###...#.#.#...#...#...#.....#...#.#.#.....###...#.#
#.#.#.#.#####.#.#.#.#.#####.#.#.#.#.#######.###.###.#.###.#.#####.###.#####.###.#.#.###.#.#####.#.#.#####.###.###.#####.###.#.#.#########.#.#
#.#...#.#...#...#...#.....#.#.#.#.#.#...#...#...#...#...#.#.#.....#...###...#...#.#...#.#.#...#.#...#...#.#...#...#...#...#.#.#...#...#...#.#
#.#####.#.#.#############.#.#.#.#.#.#.#.#.###.###.#####.#.#.#.#####.#####.###.###.###.#.#.#.#.#.#####.#.#.#.###.###.#.###.#.#.###.#.#.#.###.#
#...#...#.#.#...#.....#...#...#...#.#.#.#...#...#.#...#...#.#...#...#...#.#...#...#...#.#.#.#.#.....#.#...#...#.###.#...#.#.#.#...#.#...#...#
###.#.###.#.#.#.#.###.#.###########.#.#.###.###.#.#.#.#####.###.#.###.#.#.#.###.###.###.#.#.#.#####.#.#######.#.###.###.#.#.#.#.###.#####.###
#...#.#...#.#.#.#...#.#...........#.#.#.###.#...#.#.#.......#...#...#.#.#.#.#...#...###.#.#.#.#...#.#...#.....#...#...#.#.#...#...#.....#...#
#.###.#.###.#.#.###.#.###########.#.#.#.###.#.###.#.#########.#####.#.#.#.#.#.###.#####.#.#.#.#.#.#.###.#.#######.###.#.#.#######.#####.###.#
#...#.#...#.#.#.#...#.#...........#...#...#.#...#.#.....#...#...#...#.#...#.#...#.###...#.#.#.#.#...#...#.....#...#...#...#.......#...#.#...#
###.#.###.#.#.#.#.###.#.#################.#.###.#.#####.#.#.###.#.###.#####.###.#.###.###.#.#.#.#####.#######.#.###.#######.#######.#.#.#.###
#...#...#.#.#.#.#...#.#...............#...#...#...#.....#.#.#...#...#.....#.....#...#...#.#.#.#...#...#...#...#...#...#.....#...#...#.#.#...#
#.#####.#.#.#.#.###.#.###############.#.#####.#####.#####.#.#.#####.#####.#########.###.#.#.#.###.#.###.#.#.#####.###.#.#####.#.#.###.#.###.#
#.....#...#.#.#.....#.###.............#.......#.....#...#.#.#.....#...###...#.....#.#...#.#.#...#.#.###.#.#.#.....###.#.....#.#.#...#.#.#...#
#####.#####.#.#######.###.#####################.#####.#.#.#.#####.###.#####.#.###.#.#.###.#.###.#.#.###.#.#.#.#######.#####.#.#.###.#.#.#.###
#...#.....#.#...#...#...#.....................#...###.#.#.#.#...#.#...#...#...#...#...#...#...#...#.....#.#.#...###...#...#...#.....#...#...#
#.#.#####.#.###.#.#.###.#####################.###.###.#.#.#.#.#.#.#.###.#.#####.#######.#####.###########.#.###.###.###.#.#################.#
#.#.....#.#.###...#...#...#...###...#...#...#...#.....#.#.#.#.#...#.###.#.#...#...#...#...#...#...........#...#.....#...#.......#.....#...#.#
#.#####.#.#.#########.###.#.#.###.#.#.#.#.#.###.#######.#.#.#.#####.###.#.#.#.###.#.#.###.#.###.#############.#######.#########.#.###.#.#.#.#
#.#...#...#...#...###...#.#.#.#...#.#.#...#...#...#.....#.#.#.....#...#.#...#.#...#.#.....#...#.........#...#.#.......###...###.#...#...#...#
#.#.#.#######.#.#.#####.#.#.#.#.###.#.#######.###.#.#####.#.#####.###.#.#####.#.###.#########.#########.#.#.#.#.#########.#.###.###.#########
#...#.....#...#.#.#.....#...#...#...#.......#.#...#.#...#.#...###.#...#.#.....#...#.#.....#...#.........#.#...#.#.......#.#...#...#.........#
#########.#.###.#.#.#############.#########.#.#.###.#.#.#.###.###.#.###.#.#######.#.#.###.#.###.#########.#####.#.#####.#.###.###.#########.#
#.........#...#.#.#...#.........#...###.....#.#...#.#.#...#...#...#.###.#.....###.#.#.#...#...#.....#...#.....#.#.#.....#.#...###...#.....#.#
#.###########.#.#.###.#.#######.###.###.#####.###.#.#.#####.###.###.###.#####.###.#.#.#.#####.#####.#.#.#####.#.#.#.#####.#.#######.#.###.#.#
#...........#...#.....#.#.....#...#.#...#...#.#...#.#.....#.#...#...#...#.....#...#.#.#...#...#...#.#.#...#...#.#.#.......#...###...#...#.#.#
###########.###########.#.###.###.#.#.###.#.#.#.###.#####.#.#.###.###.###.#####.###.#.###.#.###.#.#.#.###.#.###.#.###########.###.#####.#.#.#
#...#.......#...#...#...#...#.....#.#.#...#...#.#...#...#.#.#...#.###...#.#...#...#.#.#...#...#.#...#.#...#.#...#.#.........#...#.......#...#
#.#.#.#######.#.#.#.#.#####.#######.#.#.#######.#.###.#.#.#.###.#.#####.#.#.#.###.#.#.#.#####.#.#####.#.###.#.###.#.#######.###.#############
#.#.#.......#.#...#...#####...#...#...#.#...#...#...#.#.#.#.#...#.#.....#.#.#.#...#...#...#...#...#...#...#.#.#...#.......#...#.............#
#.#.#######.#.###############.#.#.#####.#.#.#.#####.#.#.#.#.#.###.#.#####.#.#.#.#########.#.#####.#.#####.#.#.#.#########.###.#############.#
#.#.........#.#.........#...#...#...###...#.#.....#.#.#...#.#.#...#.....#.#.#.#.###.......#...#...#...#...#.#...#...#...#...#...........#...#
#.###########.#.#######.#.#.#######.#######.#####.#.#.#####.#.#.#######.#.#.#.#.###.#########.#.#####.#.###.#####.#.#.#.###.###########.#.###
#...#...#...#.#.......#.#.#...#...#.....#...#.....#.#...#...#.#...#...#.#...#.#...#...#...#...#...#...#.....#.....#...#.....#...###...#...###
###.#.#.#.#.#.#######.#.#.###.#.#.#####.#.###.#####.###.#.###.###.#.#.#.#####.###.###.#.#.#.#####.#.#########.###############.#.###.#.#######
###...#...#...#.......#.#...#.#.#.#.....#...#...###...#.#...#...#.#.#.#...#...#...###...#.#...###.#.#...#...#...#...###.......#.....#...#...#
###############.#######.###.#.#.#.#.#######.###.#####.#.###.###.#.#.#.###.#.###.#########.###.###.#.#.#.#.#.###.#.#.###.###############.#.#.#
#...#...###...#.#.....#.....#...#...#...###...#...#...#.#...#...#.#.#.#...#...#.......###.....#...#.#.#...#.....#.#.....#.........#...#...#.#
#.#.#.#.###.#.#.#.###.###############.#.#####.###.#.###.#.###.###.#.#.#.#####.#######.#########.###.#.###########.#######.#######.#.#.#####.#
#.#.#.#.#...#.#.#.###.......#...#...#.#.....#.#...#.#...#...#...#.#.#.#.....#...#...#.#.....###.....#.............#...#...#...###...#.......#
#.#.#.#.#.###.#.#.#########.#.#.#.#.#.#####.#.#.###.#.#####.###.#.#.#.#####.###.#.#.#.#.###.#######################.#.#.###.#.###############
#.#.#.#.#.#...#...#...#...#...#...#...#.....#.#.#...#.#.....#...#.#.#...#...#...#.#.#...#...#...........#...#.......#...#...#...#...###...###
#.#.#.#.#.#.#######.#.#.#.#############.#####.#.#.###.#.#####.###.#.###.#.###.###.#.#####.###.#########.#.#.#.###########.#####.#.#.###.#.###
#.#...#...#...#.....#...#.............#.#...#...#...#.#.#...#...#.#.#...#...#...#.#...#...###.....#...#.#.#.#.............#.....#.#.....#...#
#.###########.#.#####################.#.#.#.#######.#.#.#.#.###.#.#.#.#####.###.#.###.#.#########.#.#.#.#.#.###############.#####.#########.#
#.......#...#...#...#...............#.#...#.....###.#.#...#.#...#...#...#...#...#.#...#...#...#...#.#.#...#...............#.......#.........#
#######.#.#.#####.#.#.#############.#.#########.###.#.#####.#.#########.#.###.###.#.#####.#.#.#.###.#.###################.#########.#########
#.......#.#.#...#.#.#.#.....###.....#.........#.#...#.#.....#.....#.....#...#...#.#...#...#.#...#...#.........#.........#.#...#...#.........#
#.#######.#.#.#.#.#.#.#.###.###.#############.#.#.###.#.#########.#.#######.###.#.###.#.###.#####.###########.#.#######.#.#.#.#.#.#########.#
#.#...#...#.#.#...#...#...#.....#...........#...#.#...#.#...#.....#...#...#...#...#...#...#.......#.........#...#.......#...#.#.#...#...#...#
#.#.#.#.###.#.###########.#######.#########.#####.#.###.#.#.#.#######.#.#.###.#####.#####.#########.#######.#####.###########.#.###.#.#.#.###
#.#.#.#...#...###...#...#.........#...#...#...###...#...#.#.#.......#...#.....#...#.......#...#...#.......#.......#...#...###...###.#.#.#...#
#.#.#.###.#######.#.#.#.###########.#.#.#.###.#######.###.#.#######.###########.#.#########.#.#.#.#######.#########.#.#.#.#########.#.#.###.#
#.#.#.....#.......#.#.#.###.........#...#.....#...###.....#.#.......###.......#.#.#...#.....#...#.#...###.........#.#...#.....#...#...#.....#
#.#.#######.#######.#.#.###.###################.#.#########.#.#########.#####.#.#.#.#.#.#########.#.#.###########.#.#########.#.#.###########
#...#.....#.......#.#.#...#.........#...#.......#.........#.#...#.....#.....#...#...#...#...#...#...#...#.......#...#...#...#...#.......#...#
#####.###.#######.#.#.###.#########.#.#.#.###############.#.###.#.###.#####.#############.#.#.#.#######.#.#####.#####.#.#.#.###########.#.#.#
#...#...#.###...#.#.#...#.#...#...#...#...#.....#.....#...#...#...#...###...#.....#...#...#...#.....#...#.#...#.......#...#.............#.#.#
#.#.###.#.###.#.#.#.###.#.#.#.#.#.#########.###.#.###.#.#####.#####.#####.###.###.#.#.#.###########.#.###.#.#.###########################.#.#
#.#...#.#.....#...#.....#...#.#.#.#.........###...###.#.....#.#...#.....#...#.###...#.#.###.........#.....#.#.###...###...................#.#
#.###.#.#####################.#.#.#.#################.#####.#.#.#.#####.###.#.#######.#.###.###############.#.###.#.###.###################.#
#...#.#.......#.....#...#...#...#...###.............#...#...#...#.....#.#...#.#.......#...#...#.......#.....#.....#...#.#.........#.........#
###.#.#######.#.###.#.#.#.#.###########.###########.###.#.###########.#.#.###.#.#########.###.#.#####.#.#############.#.#.#######.#.#########
#...#...#...#.#.###.#.#...#.............#.......#...###.#.....#...#...#.#.....#...........###...###...#.#...........#...#.......#.#.#...#...#
#.#####.#.#.#.#.###.#.###################.#####.#.#####.#####.#.#.#.###.###########################.###.#.#########.###########.#.#.#.#.#.#.#
#.....#...#...#.#...#...#...............#.#...#...#...#.......#.#.#.....#E............#...#...#...#.....#.#.......#.#...........#...#.#.#.#.#
#####.#########.#.#####.#.#############.#.#.#.#####.#.#########.#.###################.#.#.#.#.#.#.#######.#.#####.#.#.###############.#.#.#.#
#.....#.....#...#.....#.#.............#.#...#.......#.......#...#...#...#############...#...#...#.......#...#...#.#.#.#.......#...#...#...#.#
#.#####.###.#.#######.#.#############.#.###################.#.#####.#.#.###############################.#####.#.#.#.#.#.#####.#.#.#.#######.#
#.#.....###...#...###.#.#.............#...#.............#...#...#...#.#.....###########################.......#.#.#.#...#.....#.#...#...#...#
#.#.###########.#.###.#.#.###############.#.###########.#.#####.#.###.#####.###################################.#.#.#####.#####.#####.#.#.###
#...#...........#...#...#...........#...#.#...........#.#...###.#...#...#...###################################...#.#...#...###.#.....#...###
#####.#############.###############.#.#.#.###########.#.###.###.###.###.#.#########################################.#.#.###.###.#.###########
#.....#...........#.###...#...#...#...#.#.#...........#.....#...#...#...#...#######################################...#.....#...#...........#
#.#####.#########.#.###.#.#.#.#.#.#####.#.#.#################.###.###.#####.#################################################.#############.#
#...#...#.........#.....#...#...#.....#.#.#.###...#.....#...#...#.###.....#.....#####################.....#########.....###...#...#.......#.#
###.#.###.###########################.#.#.#.###.#.#.###.#.#.###.#.#######.#####.#####################.###.#########.###.###.###.#.#.#####.#.#
###...###...#...#.....#...#.........#...#...#...#...#...#.#.#...#.....#...#.....#####....S#.....#...#...#.....#####...#...#...#.#...#...#...#
###########.#.#.#.###.#.#.#.#######.#########.#######.###.#.#.#######.#.###.#########.#####.###.#.#.###.#####.#######.###.###.#.#####.#.#####
#.......###.#.#.#.###...#...#...###.........#.#.......#...#.#.....#...#...#.#...#####.....#.###...#.....#.....###...#...#...#.#.....#.#.....#
#.#####.###.#.#.#.###########.#.###########.#.#.#######.###.#####.#.#####.#.#.#.#########.#.#############.#######.#.###.###.#.#####.#.#####.#
#.#...#.....#.#.#.#...........#.......#...#...#...#...#...#.#...#.#.#...#.#...#.#####.....#.#...#.....#...#.....#.#.#...#...#.#.....#.#.....#
#.#.#.#######.#.#.#.#################.#.#.#######.#.#.###.#.#.#.#.#.#.#.#.#####.#####.#####.#.#.#.###.#.###.###.#.#.#.###.###.#.#####.#.#####
#.#.#.....#...#...#.........#.......#...#.........#.#.....#.#.#...#.#.#.#.#.....#####...#...#.#.#...#.#.....#...#.#.#...#.....#.......#.#...#
#.#.#####.#.###############.#.#####.###############.#######.#.#####.#.#.#.#.###########.#.###.#.###.#.#######.###.#.###.###############.#.#.#
#...#.....#.#.....#...#.....#.#.....#.........###...#.....#.#.#...#.#.#.#.#.....###...#...#...#.....#.........#...#.....#...#...#.....#...#.#
#####.#####.#.###.#.#.#.#####.#.#####.#######.###.###.###.#.#.#.#.#.#.#.#.#####.###.#.#####.###################.#########.#.#.#.#.###.#####.#
#.....#...#.#...#...#...#.....#.......#.......#...#...###...#...#.#.#.#.#.#...#.#...#.....#.#...#.....#...#.....#...#.....#...#...###.......#
#.#####.#.#.###.#########.#############.#######.###.#############.#.#.#.#.#.#.#.#.#######.#.#.#.#.###.#.#.#.#####.#.#.#######################
#...#...#...###...........#...........#.....###...#.....#...###...#.#.#.#.#.#...#.......#.#...#...###...#...#.....#...#...#.........#.......#
###.#.#####################.#########.#####.#####.#####.#.#.###.###.#.#.#.#.###########.#.###################.#########.#.#.#######.#.#####.#
#...#.#.....#...#...........#.......#.....#.#.....#.....#.#.#...#...#.#.#.#...#...#.....#.###.........#.......#.........#...#.......#.#.....#
#.###.#.###.#.#.#.###########.#####.#####.#.#.#####.#####.#.#.###.###.#.#.###.#.#.#.#####.###.#######.#.#######.#############.#######.#.#####
#...#.#...#...#...#...........#.....#...#...#.....#.#...#.#.#.#...#...#.#.#...#.#.#.....#...#.......#.#.........#.....#.......###...#.#.#...#
###.#.###.#########.###########.#####.#.#########.#.#.#.#.#.#.#.###.###.#.#.###.#.#####.###.#######.#.###########.###.#.#########.#.#.#.#.#.#
#...#.#...#...#...#.#.........#.....#.#...#...#...#...#.#.#.#.#.###...#.#.#.#...#.#...#...#...#...#.#.#...........###...#.........#...#...#.#
#.###.#.###.#.#.#.#.#.#######.#####.#.###.#.#.#.#######.#.#.#.#.#####.#.#.#.#.###.#.#.###.###.#.#.#.#.#.#################.#################.#
#.....#.....#...#...#.......#.#...#.#.#...#.#.#.......#.#.#.#.#.#...#.#.#.#.#...#.#.#.###.#...#.#.#.#.#.........#...#.....#.................#
###########################.#.#.#.#.#.#.###.#.#######.#.#.#.#.#.#.#.#.#.#.#.###.#.#.#.###.#.###.#.#.#.#########.#.#.#.#####.#################
#...................#.......#...#...#.#...#.#.#...#...#...#...#.#.#...#.#.#.#...#.#.#.#...#...#.#.#.#.....#...#...#...#...#.............#...#
#.#################.#.###############.###.#.#.#.#.#.###########.#.#####.#.#.#.###.#.#.#.#####.#.#.#.#####.#.#.#########.#.#############.#.#.#
#.................#.#.............#...#...#.#.#.#.#.......#.....#.....#.#.#.#.#...#.#...###...#.#.#.....#.#.#.#.....#...#.#.......#.....#.#.#
#################.#.#############.#.###.###.#.#.#.#######.#.#########.#.#.#.#.#.###.#######.###.#.#####.#.#.#.#.###.#.###.#.#####.#.#####.#.#
#.........#...#...#...............#...#.#...#.#.#...#...#.#...#...#...#.#.#.#.#...#.......#.....#.#.....#.#.#.#...#.#...#...#...#...###...#.#
#.#######.#.#.#.#####################.#.#.###.#.###.#.#.#.###.#.#.#.###.#.#.#.###.#######.#######.#.#####.#.#.###.#.###.#####.#.#######.###.#
#.......#...#.#...........#.....#...#.#.#.#...#...#...#.#.#...#.#.#.#...#.#.#...#.#...#...#.......#.....#.#.#.#...#...#.......#.......#...#.#
#######.#####.###########.#.###.#.#.#.#.#.#.#####.#####.#.#.###.#.#.#.###.#.###.#.#.#.#.###.###########.#.#.#.#.#####.###############.###.#.#
#.......#...#.............#.###.#.#.#.#.#.#.#...#...#...#.#.#...#.#.#.....#...#.#...#.#...#.#.....#...#.#.#.#.#.....#.#.....#.........#...#.#
#.#######.#.###############.###.#.#.#.#.#.#.#.#.###.#.###.#.#.###.#.#########.#.#####.###.#.#.###.#.#.#.#.#.#.#####.#.#.###.#.#########.###.#
#.....#...#.................#...#.#.#.#.#.#.#.#.#...#...#.#.#.#...#.......###.#.#.....#...#.#...#.#.#...#.#.#.#.....#.#.#...#.........#...#.#
#####.#.#####################.###.#.#.#.#.#.#.#.#.#####.#.#.#.#.#########.###.#.#.#####.###.###.#.#.#####.#.#.#.#####.#.#.###########.###.#.#
#...#...#.....................#...#.#.#.#.#.#.#.#.....#...#...#.....#...#...#.#.#.....#...#...#.#.#.###...#.#.#...#...#.#.#...........#...#.#
#.#.#####.#####################.###.#.#.#.#.#.#.#####.#############.#.#.###.#.#.#####.###.###.#.#.#.###.###.#.###.#.###.#.#.###########.###.#
#.#...###.....#.....#...#...#...#...#.#.#.#.#.#.....#.#...#...#...#.#.#.....#...#.....#...#...#.#.#...#...#.#.....#.#...#.#.........#...#...#
#.###.#######.#.###.#.#.#.#.#.###.###.#.#.#.#.#####.#.#.#.#.#.#.#.#.#.###########.#####.###.###.#.###.###.#.#######.#.###.#########.#.###.###
#...#.........#...#...#.#.#.#...#.#...#.#.#.#...###.#...#.#.#...#...#...#...#...#...#...#...#...#.#...#...#.......#...#...#...#...#...#...###
###.#############.#####.#.#.###.#.#.###.#.#.###.###.#####.#.###########.#.#.#.#.###.#.###.###.###.#.###.#########.#####.###.#.#.#.#####.#####
#...#.....#.....#.#.....#.#...#.#...###.#.#.#...#...#...#.#.#.....#...#...#...#.#...#...#...#.#...#...#.#...#...#.#.....#...#.#.#.#...#.....#
#.###.###.#.###.#.#.#####.###.#.#######.#.#.#.###.###.#.#.#.#.###.#.#.#########.#.#####.###.#.#.#####.#.#.#.#.#.#.#.#####.###.#.#.#.#.#####.#
#.#...#...#.###...#.....#.###.#...#.....#.#...###...#.#...#.#.#...#.#...#.....#.#.#.....###.#.#.#...#.#.#.#.#.#.#.#.#...#...#...#.#.#.......#
#.#.###.###.###########.#.###.###.#.#####.#########.#.#####.#.#.###.###.#.###.#.#.#.#######.#.#.#.#.#.#.#.#.#.#.#.#.#.#.###.#####.#.#########
#.#...#...#.#...........#.#...#...#...#...###.......#.#...#...#...#...#.#.#...#.#.#...#...#...#.#.#.#.#.#.#...#...#...#.#...###...#...###...#
#.###.###.#.#.###########.#.###.#####.#.#####.#######.#.#.#######.###.#.#.#.###.#.###.#.#.#####.#.#.#.#.#.#############.#.#####.#####.###.#.#
#.#...###...#...........#.#...#.###...#.....#...#...#...#...#...#.#...#.#.#.#...#...#...#.#.....#.#.#.#.#.........#.....#...#...#...#.....#.#
#.#.###################.#.###.#.###.#######.###.#.#.#######.#.#.#.#.###.#.#.#.#####.#####.#.#####.#.#.#.#########.#.#######.#.###.#.#######.#
#.#.#.....#.............#.#...#...#.#...#...###...#...#...#...#.#.#.#...#.#.#.#...#.#.....#.#...#.#.#.#.#.....#...#.....#...#.#...#.#.....#.#
#.#.#.###.#.#############.#.#####.#.#.#.#.###########.#.#.#####.#.#.#.###.#.#.#.#.#.#.#####.#.#.#.#.#.#.#.###.#.#######.#.###.#.###.#.###.#.#
#.#.#...#...#...........#.#...#...#.#.#.#.###.........#.#.#...#.#...#...#.#.#.#.#...#.....#.#.#...#.#.#.#...#.#.#...#...#...#.#.###.#...#.#.#
#.#.###.#####.#########.#.###.#.###.#.#.#.###.#########.#.#.#.#.#######.#.#.#.#.#########.#.#.#####.#.#.###.#.#.#.#.#.#####.#.#.###.###.#.#.#
#...###.......#...#.....#...#.#...#.#.#.#...#.......#...#.#.#.#.....###...#.#.#.......#...#.#...###...#.#...#...#.#...#.....#...#...#...#.#.#
###############.#.#.#######.#.###.#.#.#.###.#######.#.###.#.#.#####.#######.#.#######.#.###.###.#######.#.#######.#####.#########.###.###.#.#
#...............#...#.....#.#...#.#.#.#.#...#.......#.#...#.#.#...#.......#.#.#.......#...#.#...#.......#.......#...#...#.........#...#...#.#
#.###################.###.#.###.#.#.#.#.#.###.#######.#.###.#.#.#.#######.#.#.#.#########.#.#.###.#############.###.#.###.#########.###.###.#
#.....................###...###...#...#...###.........#.....#...#.........#...#...........#...###...............###...###...........###.....#
#############################################################################################################################################
~

AOC2024Day20.list2
###############
#...#...#.....#
#.#.#.#.#.###.#
#S#...#.#.#...#
#######.#.#.###
#######.#.#...#
#######.#.###.#
###..E#...#...#
###.#######.###
#...###...#...#
#.#####.#.###.#
#.#...#.#.#...#
#.#.#.#.#.#.###
#...#...#...###
###############
~
(5,1)-(3,1)4
(9,1)-(7,1)12
(3,2)-(1,2)2
(5,2)-(3,2)2
(7,2)-(5,2)2
(9,2)-(7,2)10
(3,3)-(1,3)4
(7,3)-(5,3)4
(9,3)-(7,3)8
(11,3)-(11,1)4
(11,3)-(9,3)8
(12,3)-(12,1)2
(9,4)-(7,4)6
(11,4)-(9,4)10
(9,5)-(7,5)4
(11,5)-(9,5)12
(12,5)-(12,3)2
(13,5)-(13,3)4
(9,6)-(7,6)2
(5,7)-(7,7)64
(11,7)-(11,5)4
(11,7)-(9,7)20
(12,7)-(12,5)2
(3,9)-(3,11)8
(7,9)-(7,7)40
(8,9)-(8,7)38
(9,9)-(9,7)36
(9,9)-(11,9)12
(12,9)-(12,7)2
(13,9)-(13,7)4
(7,10)-(9,10)2
(1,11)-(3,11)4
(5,11)-(7,11)4
(7,11)-(9,11)4
(9,11)-(11,11)4
(11,11)-(11,9)4
(12,11)-(12,9)2
(1,12)-(3,12)2
(3,12)-(5,12)2
(5,12)-(7,12)2
(7,12)-(9,12)6
(9,12)-(11,12)2
(3,13)-(5,13)4
(7,13)-(9,13)8
